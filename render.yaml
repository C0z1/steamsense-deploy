services:
  # ── Backend FastAPI ─────────────────────────────────────────────────────────
  - type: web
    name: steamsense-backend
    runtime: python
    plan: free          # ← Free tier (evita el cobro de $7/mes del Starter)
    rootDir: backend
    buildCommand: pip install -r requirements.txt
    startCommand: uvicorn main:app --host 0.0.0.0 --port $PORT
    healthCheckPath: /health

    disk:
      name: steamsense-db
      mountPath: /data
      sizeGB: 1         # $0.25/mes — necesario para persistencia de DuckDB

    envVars:
      - key: ENV
        value: production
      - key: DUCKDB_PATH
        value: /data/steamsense.duckdb
      - key: TOP_N_GAMES
        value: "200"
      # ⚠️ Estas variables las pones MANUALMENTE en el dashboard de Render
      # Nunca pongas secrets hardcodeados aquí si el repo es público
      - key: STEAM_API_KEY
        sync: false
      - key: ITAD_API_KEY
        sync: false
      - key: JWT_SECRET
        sync: false
      - key: CORS_ORIGINS
        sync: false   # Tu URL de Vercel: https://steamsense-xxx.vercel.app
      - key: FRONTEND_URL
        sync: false   # Mismo valor que CORS_ORIGINS
      - key: BACKEND_URL
        sync: false   # Tu URL de Render: https://steamsense-backend.onrender.com